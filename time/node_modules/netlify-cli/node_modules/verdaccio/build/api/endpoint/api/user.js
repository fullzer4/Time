"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = _default;

var _cookies = _interopRequireDefault(require("cookies"));

var _express = _interopRequireDefault(require("express"));

var _lodash = _interopRequireDefault(require("lodash"));

var _authUtils = require("../../../lib/auth-utils");

var _constants = require("../../../lib/constants");

var _logger = require("../../../lib/logger");

var _utils = require("../../../lib/utils");

var _rateLimiter = require("../../rate-limiter");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _default(route, auth, config) {
  /* eslint new-cap:off */
  const userRouter = _express.default.Router();

  userRouter.get('/-/user/:org_couchdb_user', (0, _rateLimiter.limiter)(config === null || config === void 0 ? void 0 : config.userRateLimit), function (req, res, next) {
    res.status(_constants.HTTP_STATUS.OK);
    next({
      ok: (0, _authUtils.getAuthenticatedMessage)(req.remote_user.name)
    });
  });
  userRouter.put('/-/user/:org_couchdb_user/:_rev?/:revision?', (0, _rateLimiter.limiter)(config === null || config === void 0 ? void 0 : config.userRateLimit), function (req, res, next) {
    const {
      name,
      password
    } = req.body;
    const remoteName = req.remote_user.name;

    if (_lodash.default.isNil(remoteName) === false && _lodash.default.isNil(name) === false && remoteName === name) {
      auth.authenticate(name, password, async function callbackAuthenticate(err, user) {
        if (err) {
          _logger.logger.error({
            name,
            err
          }, 'authenticating for user @{username} failed. Error: @{err.message}');

          return next(_utils.ErrorCode.getCode(_constants.HTTP_STATUS.UNAUTHORIZED, _constants.API_ERROR.BAD_USERNAME_PASSWORD));
        }

        const restoredRemoteUser = (0, _authUtils.createRemoteUser)(name, user.groups || []);
        const token = await (0, _authUtils.getApiToken)(auth, config, restoredRemoteUser, password);
        res.status(_constants.HTTP_STATUS.CREATED);
        res.set(_constants.HEADERS.CACHE_CONTROL, 'no-cache, no-store');
        return next({
          ok: (0, _authUtils.getAuthenticatedMessage)(req.remote_user.name),
          token
        });
      });
    } else {
      if ((0, _authUtils.validatePassword)(password) === false) {
        // eslint-disable-next-line new-cap
        return next(_utils.ErrorCode.getCode(_constants.HTTP_STATUS.BAD_REQUEST, _constants.API_ERROR.PASSWORD_SHORT()));
      }

      auth.add_user(name, password, async function (err, user) {
        if (err) {
          if (err.status >= _constants.HTTP_STATUS.BAD_REQUEST && err.status < _constants.HTTP_STATUS.INTERNAL_ERROR) {
            // With npm registering is the same as logging in,
            // and npm accepts only an 409 error.
            // So, changing status code here.
            return next(_utils.ErrorCode.getCode(err.status, err.message) || _utils.ErrorCode.getConflict(err.message));
          }

          return next(err);
        }

        const token = name && password ? await (0, _authUtils.getApiToken)(auth, config, user, password) : undefined;
        req.remote_user = user;
        res.status(_constants.HTTP_STATUS.CREATED);
        res.set(_constants.HEADERS.CACHE_CONTROL, 'no-cache, no-store');
        return next({
          ok: `user '${req.body.name}' created`,
          token
        });
      });
    }
  });
  userRouter.delete('/-/user/token/*', (0, _rateLimiter.limiter)(config === null || config === void 0 ? void 0 : config.userRateLimit), function (req, res, next) {
    res.status(_constants.HTTP_STATUS.OK);
    next({
      ok: _constants.API_MESSAGE.LOGGED_OUT
    });
  }); // placeholder 'cause npm require to be authenticated to publish
  // we do not do any real authentication yet

  userRouter.post('/_session', _cookies.default.express(), function (req, res, next) {
    res.cookies.set('AuthSession', String(Math.random()), (0, _authUtils.createSessionToken)());
    next({
      ok: true,
      name: 'somebody',
      roles: []
    });
  });
  route.use(userRouter);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyb3V0ZSIsImF1dGgiLCJjb25maWciLCJ1c2VyUm91dGVyIiwiZXhwcmVzcyIsIlJvdXRlciIsImdldCIsInVzZXJSYXRlTGltaXQiLCJyZXEiLCJyZXMiLCJuZXh0Iiwic3RhdHVzIiwiSFRUUF9TVEFUVVMiLCJPSyIsIm9rIiwicmVtb3RlX3VzZXIiLCJuYW1lIiwicHV0IiwicGFzc3dvcmQiLCJib2R5IiwicmVtb3RlTmFtZSIsIl8iLCJpc05pbCIsImF1dGhlbnRpY2F0ZSIsImNhbGxiYWNrQXV0aGVudGljYXRlIiwiZXJyIiwidXNlciIsImxvZ2dlciIsImVycm9yIiwiRXJyb3JDb2RlIiwiZ2V0Q29kZSIsIlVOQVVUSE9SSVpFRCIsIkFQSV9FUlJPUiIsIkJBRF9VU0VSTkFNRV9QQVNTV09SRCIsInJlc3RvcmVkUmVtb3RlVXNlciIsImdyb3VwcyIsInRva2VuIiwiQ1JFQVRFRCIsInNldCIsIkhFQURFUlMiLCJDQUNIRV9DT05UUk9MIiwiQkFEX1JFUVVFU1QiLCJQQVNTV09SRF9TSE9SVCIsImFkZF91c2VyIiwiSU5URVJOQUxfRVJST1IiLCJtZXNzYWdlIiwiZ2V0Q29uZmxpY3QiLCJ1bmRlZmluZWQiLCJkZWxldGUiLCJBUElfTUVTU0FHRSIsIkxPR0dFRF9PVVQiLCJwb3N0IiwiQ29va2llcyIsImNvb2tpZXMiLCJTdHJpbmciLCJNYXRoIiwicmFuZG9tIiwicm9sZXMiLCJ1c2UiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvYXBpL2VuZHBvaW50L2FwaS91c2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb29raWVzIGZyb20gJ2Nvb2tpZXMnO1xuaW1wb3J0IGV4cHJlc3MsIHsgUmVzcG9uc2UsIFJvdXRlciB9IGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuaW1wb3J0IHsgQ29uZmlnLCBSZW1vdGVVc2VyIH0gZnJvbSAnQHZlcmRhY2Npby90eXBlcyc7XG5cbmltcG9ydCB7ICROZXh0RnVuY3Rpb25WZXIsICRSZXF1ZXN0RXh0ZW5kLCAkUmVzcG9uc2VFeHRlbmQsIElBdXRoIH0gZnJvbSAnLi4vLi4vLi4vLi4vdHlwZXMnO1xuaW1wb3J0IHsgY3JlYXRlUmVtb3RlVXNlciwgY3JlYXRlU2Vzc2lvblRva2VuLCBnZXRBcGlUb2tlbiwgZ2V0QXV0aGVudGljYXRlZE1lc3NhZ2UsIHZhbGlkYXRlUGFzc3dvcmQgfSBmcm9tICcuLi8uLi8uLi9saWIvYXV0aC11dGlscyc7XG5pbXBvcnQgeyBBUElfRVJST1IsIEFQSV9NRVNTQUdFLCBIRUFERVJTLCBIVFRQX1NUQVRVUyB9IGZyb20gJy4uLy4uLy4uL2xpYi9jb25zdGFudHMnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vLi4vLi4vbGliL2xvZ2dlcic7XG5pbXBvcnQgeyBFcnJvckNvZGUgfSBmcm9tICcuLi8uLi8uLi9saWIvdXRpbHMnO1xuaW1wb3J0IHsgbGltaXRlciB9IGZyb20gJy4uLy4uL3JhdGUtbGltaXRlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIChyb3V0ZTogUm91dGVyLCBhdXRoOiBJQXV0aCwgY29uZmlnOiBDb25maWcpOiB2b2lkIHtcbiAgLyogZXNsaW50IG5ldy1jYXA6b2ZmICovXG4gIGNvbnN0IHVzZXJSb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG4gIHVzZXJSb3V0ZXIuZ2V0KCcvLS91c2VyLzpvcmdfY291Y2hkYl91c2VyJywgbGltaXRlcihjb25maWc/LnVzZXJSYXRlTGltaXQpLCBmdW5jdGlvbiAocmVxOiAkUmVxdWVzdEV4dGVuZCwgcmVzOiBSZXNwb25zZSwgbmV4dDogJE5leHRGdW5jdGlvblZlcik6IHZvaWQge1xuICAgIHJlcy5zdGF0dXMoSFRUUF9TVEFUVVMuT0spO1xuICAgIG5leHQoe1xuICAgICAgb2s6IGdldEF1dGhlbnRpY2F0ZWRNZXNzYWdlKHJlcS5yZW1vdGVfdXNlci5uYW1lKSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdXNlclJvdXRlci5wdXQoJy8tL3VzZXIvOm9yZ19jb3VjaGRiX3VzZXIvOl9yZXY/LzpyZXZpc2lvbj8nLCBsaW1pdGVyKGNvbmZpZz8udXNlclJhdGVMaW1pdCksIGZ1bmN0aW9uIChyZXE6ICRSZXF1ZXN0RXh0ZW5kLCByZXM6IFJlc3BvbnNlLCBuZXh0OiAkTmV4dEZ1bmN0aW9uVmVyKTogdm9pZCB7XG4gICAgY29uc3QgeyBuYW1lLCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7XG4gICAgY29uc3QgcmVtb3RlTmFtZSA9IHJlcS5yZW1vdGVfdXNlci5uYW1lO1xuXG4gICAgaWYgKF8uaXNOaWwocmVtb3RlTmFtZSkgPT09IGZhbHNlICYmIF8uaXNOaWwobmFtZSkgPT09IGZhbHNlICYmIHJlbW90ZU5hbWUgPT09IG5hbWUpIHtcbiAgICAgIGF1dGguYXV0aGVudGljYXRlKG5hbWUsIHBhc3N3b3JkLCBhc3luYyBmdW5jdGlvbiBjYWxsYmFja0F1dGhlbnRpY2F0ZShlcnIsIHVzZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcih7IG5hbWUsIGVyciB9LCAnYXV0aGVudGljYXRpbmcgZm9yIHVzZXIgQHt1c2VybmFtZX0gZmFpbGVkLiBFcnJvcjogQHtlcnIubWVzc2FnZX0nKTtcbiAgICAgICAgICByZXR1cm4gbmV4dChFcnJvckNvZGUuZ2V0Q29kZShIVFRQX1NUQVRVUy5VTkFVVEhPUklaRUQsIEFQSV9FUlJPUi5CQURfVVNFUk5BTUVfUEFTU1dPUkQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlc3RvcmVkUmVtb3RlVXNlcjogUmVtb3RlVXNlciA9IGNyZWF0ZVJlbW90ZVVzZXIobmFtZSwgdXNlci5ncm91cHMgfHwgW10pO1xuICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGdldEFwaVRva2VuKGF1dGgsIGNvbmZpZywgcmVzdG9yZWRSZW1vdGVVc2VyLCBwYXNzd29yZCk7XG5cbiAgICAgICAgcmVzLnN0YXR1cyhIVFRQX1NUQVRVUy5DUkVBVEVEKTtcbiAgICAgICAgcmVzLnNldChIRUFERVJTLkNBQ0hFX0NPTlRST0wsICduby1jYWNoZSwgbm8tc3RvcmUnKTtcbiAgICAgICAgcmV0dXJuIG5leHQoe1xuICAgICAgICAgIG9rOiBnZXRBdXRoZW50aWNhdGVkTWVzc2FnZShyZXEucmVtb3RlX3VzZXIubmFtZSksXG4gICAgICAgICAgdG9rZW4sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh2YWxpZGF0ZVBhc3N3b3JkKHBhc3N3b3JkKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5ldy1jYXBcbiAgICAgICAgcmV0dXJuIG5leHQoRXJyb3JDb2RlLmdldENvZGUoSFRUUF9TVEFUVVMuQkFEX1JFUVVFU1QsIEFQSV9FUlJPUi5QQVNTV09SRF9TSE9SVCgpKSk7XG4gICAgICB9XG5cbiAgICAgIGF1dGguYWRkX3VzZXIobmFtZSwgcGFzc3dvcmQsIGFzeW5jIGZ1bmN0aW9uIChlcnIsIHVzZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGlmIChlcnIuc3RhdHVzID49IEhUVFBfU1RBVFVTLkJBRF9SRVFVRVNUICYmIGVyci5zdGF0dXMgPCBIVFRQX1NUQVRVUy5JTlRFUk5BTF9FUlJPUikge1xuICAgICAgICAgICAgLy8gV2l0aCBucG0gcmVnaXN0ZXJpbmcgaXMgdGhlIHNhbWUgYXMgbG9nZ2luZyBpbixcbiAgICAgICAgICAgIC8vIGFuZCBucG0gYWNjZXB0cyBvbmx5IGFuIDQwOSBlcnJvci5cbiAgICAgICAgICAgIC8vIFNvLCBjaGFuZ2luZyBzdGF0dXMgY29kZSBoZXJlLlxuICAgICAgICAgICAgcmV0dXJuIG5leHQoRXJyb3JDb2RlLmdldENvZGUoZXJyLnN0YXR1cywgZXJyLm1lc3NhZ2UpIHx8IEVycm9yQ29kZS5nZXRDb25mbGljdChlcnIubWVzc2FnZSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbmV4dChlcnIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdG9rZW4gPSBuYW1lICYmIHBhc3N3b3JkID8gYXdhaXQgZ2V0QXBpVG9rZW4oYXV0aCwgY29uZmlnLCB1c2VyLCBwYXNzd29yZCkgOiB1bmRlZmluZWQ7XG5cbiAgICAgICAgcmVxLnJlbW90ZV91c2VyID0gdXNlcjtcbiAgICAgICAgcmVzLnN0YXR1cyhIVFRQX1NUQVRVUy5DUkVBVEVEKTtcbiAgICAgICAgcmVzLnNldChIRUFERVJTLkNBQ0hFX0NPTlRST0wsICduby1jYWNoZSwgbm8tc3RvcmUnKTtcbiAgICAgICAgcmV0dXJuIG5leHQoe1xuICAgICAgICAgIG9rOiBgdXNlciAnJHtyZXEuYm9keS5uYW1lfScgY3JlYXRlZGAsXG4gICAgICAgICAgdG9rZW4sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICB1c2VyUm91dGVyLmRlbGV0ZSgnLy0vdXNlci90b2tlbi8qJywgbGltaXRlcihjb25maWc/LnVzZXJSYXRlTGltaXQpLCBmdW5jdGlvbiAocmVxOiAkUmVxdWVzdEV4dGVuZCwgcmVzOiBSZXNwb25zZSwgbmV4dDogJE5leHRGdW5jdGlvblZlcik6IHZvaWQge1xuICAgIHJlcy5zdGF0dXMoSFRUUF9TVEFUVVMuT0spO1xuICAgIG5leHQoe1xuICAgICAgb2s6IEFQSV9NRVNTQUdFLkxPR0dFRF9PVVQsXG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIHBsYWNlaG9sZGVyICdjYXVzZSBucG0gcmVxdWlyZSB0byBiZSBhdXRoZW50aWNhdGVkIHRvIHB1Ymxpc2hcbiAgLy8gd2UgZG8gbm90IGRvIGFueSByZWFsIGF1dGhlbnRpY2F0aW9uIHlldFxuICB1c2VyUm91dGVyLnBvc3QoJy9fc2Vzc2lvbicsIENvb2tpZXMuZXhwcmVzcygpLCBmdW5jdGlvbiAocmVxOiAkUmVxdWVzdEV4dGVuZCwgcmVzOiAkUmVzcG9uc2VFeHRlbmQsIG5leHQ6ICROZXh0RnVuY3Rpb25WZXIpOiB2b2lkIHtcbiAgICByZXMuY29va2llcy5zZXQoJ0F1dGhTZXNzaW9uJywgU3RyaW5nKE1hdGgucmFuZG9tKCkpLCBjcmVhdGVTZXNzaW9uVG9rZW4oKSk7XG5cbiAgICBuZXh0KHtcbiAgICAgIG9rOiB0cnVlLFxuICAgICAgbmFtZTogJ3NvbWVib2R5JyxcbiAgICAgIHJvbGVzOiBbXSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgcm91dGUudXNlKHVzZXJSb3V0ZXIpO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBS0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFFZSxrQkFBVUEsS0FBVixFQUF5QkMsSUFBekIsRUFBc0NDLE1BQXRDLEVBQTREO0VBQ3pFO0VBQ0EsTUFBTUMsVUFBVSxHQUFHQyxpQkFBUUMsTUFBUixFQUFuQjs7RUFFQUYsVUFBVSxDQUFDRyxHQUFYLENBQWUsMkJBQWYsRUFBNEMsMEJBQVFKLE1BQVIsYUFBUUEsTUFBUix1QkFBUUEsTUFBTSxDQUFFSyxhQUFoQixDQUE1QyxFQUE0RSxVQUFVQyxHQUFWLEVBQStCQyxHQUEvQixFQUE4Q0MsSUFBOUMsRUFBNEU7SUFDdEpELEdBQUcsQ0FBQ0UsTUFBSixDQUFXQyx1QkFBWUMsRUFBdkI7SUFDQUgsSUFBSSxDQUFDO01BQ0hJLEVBQUUsRUFBRSx3Q0FBd0JOLEdBQUcsQ0FBQ08sV0FBSixDQUFnQkMsSUFBeEM7SUFERCxDQUFELENBQUo7RUFHRCxDQUxEO0VBT0FiLFVBQVUsQ0FBQ2MsR0FBWCxDQUFlLDZDQUFmLEVBQThELDBCQUFRZixNQUFSLGFBQVFBLE1BQVIsdUJBQVFBLE1BQU0sQ0FBRUssYUFBaEIsQ0FBOUQsRUFBOEYsVUFBVUMsR0FBVixFQUErQkMsR0FBL0IsRUFBOENDLElBQTlDLEVBQTRFO0lBQ3hLLE1BQU07TUFBRU0sSUFBRjtNQUFRRTtJQUFSLElBQXFCVixHQUFHLENBQUNXLElBQS9CO0lBQ0EsTUFBTUMsVUFBVSxHQUFHWixHQUFHLENBQUNPLFdBQUosQ0FBZ0JDLElB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