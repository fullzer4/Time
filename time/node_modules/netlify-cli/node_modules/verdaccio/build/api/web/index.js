"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = _default;
exports.loadTheme = loadTheme;
exports.validatePrimaryColor = validatePrimaryColor;

var _debug = _interopRequireDefault(require("debug"));

var _express = _interopRequireDefault(require("express"));

var _fs = _interopRequireDefault(require("fs"));

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

var _constants = require("../../lib/constants");

var _logger = require("../../lib/logger");

var _pluginLoader = _interopRequireDefault(require("../../lib/plugin-loader"));

var _search = _interopRequireDefault(require("../../lib/search"));

var _utils = require("../../lib/utils");

var _renderHTML = _interopRequireDefault(require("./html/renderHTML"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const {
  setSecurityWebHeaders
} = require('../middleware');

const debug = (0, _debug.default)('verdaccio');

function loadTheme(config) {
  if (_lodash.default.isNil(config.theme) === false) {
    return _lodash.default.head((0, _pluginLoader.default)(config, config.theme, {}, function (plugin) {
      return plugin.staticPath && plugin.manifest && plugin.manifestFiles;
    }, 'verdaccio-theme'));
  }
}

function validatePrimaryColor(primaryColor) {
  const isHex = /^#+([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/i.test(primaryColor);

  if (!isHex) {
    debug('invalid primary color %o', primaryColor);
    return;
  }

  return primaryColor;
}

const sendFileCallback = next => err => {
  if (!err) {
    return;
  }

  if (err.status === _constants.HTTP_STATUS.NOT_FOUND) {
    next();
  } else {
    next(err);
  }
};

function _default(config, auth, storage) {
  var _config$web, _config$web2;

  let {
    staticPath,
    manifest,
    manifestFiles
  } = loadTheme(config) || require('@verdaccio/ui-theme')();

  debug('static path %o', staticPath);

  _search.default.configureStorage(storage);
  /* eslint new-cap:off */


  const router = _express.default.Router(); // run in production mode by default, just in case
  // it shouldn't make any difference anyway


  router.use(auth.webUIJWTmiddleware());
  router.use(setSecurityWebHeaders); // static assets

  router.get('/-/static/*', function (req, res, next) {
    const filename = req.params[0];
    const file = `${staticPath}/${filename}`;
    debug('render static file %o', file);
    res.sendFile(file, sendFileCallback(next));
  }); // logo

  if (config !== null && config !== void 0 && (_config$web = config.web) !== null && _config$web !== void 0 && _config$web.logo && !(0, _utils.isHTTPProtocol)(config === null || config === void 0 ? void 0 : (_config$web2 = config.web) === null || _config$web2 === void 0 ? void 0 : _config$web2.logo)) {
    // URI related to a local file
    const absoluteLocalFile = _path.default.posix.resolve(config.web.logo);

    debug('serve local logo %s', absoluteLocalFile);

    try {
      if (_fs.default.existsSync(absoluteLocalFile) && typeof _fs.default.accessSync(absoluteLocalFile, _fs.default.constants.R_OK) === 'undefined') {
        // Note: `path.join` will break on Windows, because it transforms `/` to `\`
        // Use POSIX version `path.posix.join` instead.
        config.web.logo = _path.default.posix.join('/-/static/', _path.default.basename(config.web.logo));
        router.get(config.web.logo, function (_req, res, next) {
          // @ts-ignore
          debug('serve custom logo  web:%s - local:%s', config.web.logo, absoluteLocalFile);
          res.sendFile(absoluteLocalFile, sendFileCallback(next));
        });
        debug('enabled custom logo %s', config.web.logo);
      } else {
        config.web.logo = undefined;

        _logger.logger.warn(`web logo is wrong, path ${absoluteLocalFile} does not exist or is not readable`);
      }
    } catch {
      config.web.logo = undefined;

      _logger.logger.warn(`web logo is wrong, path ${absoluteLocalFile} does not exist or is not readable`);
    }
  }

  router.get('/-/web/:section/*', function (req, res) {
    (0, _renderHTML.default)(config, manifest, manifestFiles, req, res);
    debug('render html section');
  });
  router.get('/', function (req, res, next) {
    (0, _renderHTML.default)(config, manifest, manifestFiles, req, res);
    debug('render root');
  });
  return router;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZXRTZWN1cml0eVdlYkhlYWRlcnMiLCJyZXF1aXJlIiwiZGVidWciLCJsb2FkVGhlbWUiLCJjb25maWciLCJfIiwiaXNOaWwiLCJ0aGVtZSIsImhlYWQiLCJwbHVnaW4iLCJzdGF0aWNQYXRoIiwibWFuaWZlc3QiLCJtYW5pZmVzdEZpbGVzIiwidmFsaWRhdGVQcmltYXJ5Q29sb3IiLCJwcmltYXJ5Q29sb3IiLCJpc0hleCIsInRlc3QiLCJzZW5kRmlsZUNhbGxiYWNrIiwibmV4dCIsImVyciIsInN0YXR1cyIsIkhUVFBfU1RBVFVTIiwiTk9UX0ZPVU5EIiwiYXV0aCIsInN0b3JhZ2UiLCJTZWFyY2giLCJjb25maWd1cmVTdG9yYWdlIiwicm91dGVyIiwiZXhwcmVzcyIsIlJvdXRlciIsInVzZSIsIndlYlVJSldUbWlkZGxld2FyZSIsImdldCIsInJlcSIsInJlcyIsImZpbGVuYW1lIiwicGFyYW1zIiwiZmlsZSIsInNlbmRGaWxlIiwid2ViIiwibG9nbyIsImFic29sdXRlTG9jYWxGaWxlIiwicGF0aCIsInBvc2l4IiwicmVzb2x2ZSIsImZzIiwiZXhpc3RzU3luYyIsImFjY2Vzc1N5bmMiLCJjb25zdGFudHMiLCJSX09LIiwiam9pbiIsImJhc2VuYW1lIiwiX3JlcSIsInVuZGVmaW5lZCIsImxvZ2dlciIsIndhcm4iXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvYXBpL3dlYi9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYnVpbGREZWJ1ZyBmcm9tICdkZWJ1Zyc7XG5pbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cbmltcG9ydCB7IENvbmZpZyB9IGZyb20gJ0B2ZXJkYWNjaW8vdHlwZXMnO1xuXG5pbXBvcnQgeyBIVFRQX1NUQVRVUyB9IGZyb20gJy4uLy4uL2xpYi9jb25zdGFudHMnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vLi4vbGliL2xvZ2dlcic7XG5pbXBvcnQgbG9hZFBsdWdpbiBmcm9tICcuLi8uLi9saWIvcGx1Z2luLWxvYWRlcic7XG5pbXBvcnQgU2VhcmNoIGZyb20gJy4uLy4uL2xpYi9zZWFyY2gnO1xuaW1wb3J0IHsgaXNIVFRQUHJvdG9jb2wgfSBmcm9tICcuLi8uLi9saWIvdXRpbHMnO1xuaW1wb3J0IHJlbmRlckhUTUwgZnJvbSAnLi9odG1sL3JlbmRlckhUTUwnO1xuXG5jb25zdCB7IHNldFNlY3VyaXR5V2ViSGVhZGVycyB9ID0gcmVxdWlyZSgnLi4vbWlkZGxld2FyZScpO1xuXG5jb25zdCBkZWJ1ZyA9IGJ1aWxkRGVidWcoJ3ZlcmRhY2NpbycpO1xuXG5leHBvcnQgZnVuY3Rpb24gbG9hZFRoZW1lKGNvbmZpZykge1xuICBpZiAoXy5pc05pbChjb25maWcudGhlbWUpID09PSBmYWxzZSkge1xuICAgIHJldHVybiBfLmhlYWQoXG4gICAgICBsb2FkUGx1Z2luKFxuICAgICAgICBjb25maWcsXG4gICAgICAgIGNvbmZpZy50aGVtZSxcbiAgICAgICAge30sXG4gICAgICAgIGZ1bmN0aW9uIChwbHVnaW4pIHtcbiAgICAgICAgICByZXR1cm4gcGx1Z2luLnN0YXRpY1BhdGggJiYgcGx1Z2luLm1hbmlmZXN0ICYmIHBsdWdpbi5tYW5pZmVzdEZpbGVzO1xuICAgICAgICB9LFxuICAgICAgICAndmVyZGFjY2lvLXRoZW1lJ1xuICAgICAgKVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUHJpbWFyeUNvbG9yKHByaW1hcnlDb2xvcikge1xuICBjb25zdCBpc0hleCA9IC9eIysoW2EtZkEtRjAtOV17Nn18W2EtZkEtRjAtOV17M30pJC9pLnRlc3QocHJpbWFyeUNvbG9yKTtcbiAgaWYgKCFpc0hleCkge1xuICAgIGRlYnVnKCdpbnZhbGlkIHByaW1hcnkgY29sb3IgJW8nLCBwcmltYXJ5Q29sb3IpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHJldHVybiBwcmltYXJ5Q29sb3I7XG59XG5cbmNvbnN0IHNlbmRGaWxlQ2FsbGJhY2sgPSAobmV4dCkgPT4gKGVycikgPT4ge1xuICBpZiAoIWVycikge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoZXJyLnN0YXR1cyA9PT0gSFRUUF9TVEFUVVMuTk9UX0ZPVU5EKSB7XG4gICAgbmV4dCgpO1xuICB9IGVsc2Uge1xuICAgIG5leHQoZXJyKTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKGNvbmZpZzogQ29uZmlnLCBhdXRoLCBzdG9yYWdlKSB7XG4gIGxldCB7IHN0YXRpY1BhdGgsIG1hbmlmZXN0LCBtYW5pZmVzdEZpbGVzIH0gPSBsb2FkVGhlbWUoY29uZmlnKSB8fCByZXF1aXJlKCdAdmVyZGFjY2lvL3VpLXRoZW1lJykoKTtcbiAgZGVidWcoJ3N0YXRpYyBwYXRoICVvJywgc3RhdGljUGF0aCk7XG4gIFNlYXJjaC5jb25maWd1cmVTdG9yYWdlKHN0b3JhZ2UpO1xuXG4gIC8qIGVzbGludCBuZXctY2FwOm9mZiAqL1xuICBjb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuICAvLyBydW4gaW4gcHJvZHVjdGlvbiBtb2RlIGJ5IGRlZmF1bHQsIGp1c3QgaW4gY2FzZVxuICAvLyBpdCBzaG91bGRuJ3QgbWFrZSBhbnkgZGlmZmVyZW5jZSBhbnl3YXlcbiAgcm91dGVyLnVzZShhdXRoLndlYlVJSldUbWlkZGxld2FyZSgpKTtcbiAgcm91dGVyLnVzZShzZXRTZWN1cml0eVdlYkhlYWRlcnMpO1xuXG4gIC8vIHN0YXRpYyBhc3NldHNcbiAgcm91dGVyLmdldCgnLy0vc3RhdGljLyonLCBmdW5jdGlvbiAocmVxLCByZXMsIG5leHQpIHtcbiAgICBjb25zdCBmaWxlbmFtZSA9IHJlcS5wYXJhbXNbMF07XG4gICAgY29uc3QgZmlsZSA9IGAke3N0YXRpY1BhdGh9LyR7ZmlsZW5hbWV9YDtcbiAgICBkZWJ1ZygncmVuZGVyIHN0YXRpYyBmaWxlICVvJywgZmlsZSk7XG4gICAgcmVzLnNlbmRGaWxlKGZpbGUsIHNlbmRGaWxlQ2FsbGJhY2sobmV4dCkpO1xuICB9KTtcblxuICAvLyBsb2dvXG4gIGlmIChjb25maWc/LndlYj8ubG9nbyAmJiAhaXNIVFRQUHJvdG9jb2woY29uZmlnPy53ZWI/LmxvZ28pKSB7XG4gICAgLy8gVVJJIHJlbGF0ZWQgdG8gYSBsb2NhbCBmaWxlXG4gICAgY29uc3QgYWJzb2x1dGVMb2NhbEZpbGUgPSBwYXRoLnBvc2l4LnJlc29sdmUoY29uZmlnLndlYi5sb2dvKTtcbiAgICBkZWJ1Zygnc2VydmUgbG9jYWwgbG9nbyAlcycsIGFic29sdXRlTG9jYWxGaWxlKTtcbiAgICB0cnkge1xuICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoYWJzb2x1dGVMb2NhbEZpbGUpICYmIHR5cGVvZiBmcy5hY2Nlc3NTeW5jKGFic29sdXRlTG9jYWxGaWxlLCBmcy5jb25zdGFudHMuUl9PSykgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIC8vIE5vdGU6IGBwYXRoLmpvaW5gIHdpbGwgYnJlYWsgb24gV2luZG93cywgYmVjYXVzZSBpdCB0cmFuc2Zvcm1zIGAvYCB0byBgXFxgXG4gICAgICAgIC8vIFVzZSBQT1NJWCB2ZXJzaW9uIGBwYXRoLnBvc2l4LmpvaW5gIGluc3RlYWQuXG4gICAgICAgIGNvbmZpZy53ZWIubG9nbyA9IHBhdGgucG9zaXguam9pbignLy0vc3RhdGljLycsIHBhdGguYmFzZW5hbWUoY29uZmlnLndlYi5sb2dvKSk7XG4gICAgICAgIHJvdXRlci5nZXQoY29uZmlnLndlYi5sb2dvLCBmdW5jdGlvbiAoX3JlcSwgcmVzLCBuZXh0KSB7XG4gICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgIGRlYnVnKCdzZXJ2ZSBjdXN0b20gbG9nbyAgd2ViOiVzIC0gbG9jYWw6JXMnLCBjb25maWcud2ViLmxvZ28sIGFic29sdXRlTG9jYWxGaWxlKTtcbiAgICAgICAgICByZXMuc2VuZEZpbGUoYWJzb2x1dGVMb2NhbEZpbGUsIHNlbmRGaWxlQ2FsbGJhY2sobmV4dCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgZGVidWcoJ2VuYWJsZWQgY3VzdG9tIGxvZ28gJXMnLCBjb25maWcud2ViLmxvZ28pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uZmlnLndlYi5sb2dvID0gdW5kZWZpbmVkO1xuICAgICAgICBsb2dnZXIud2Fybihgd2ViIGxvZ28gaXMgd3JvbmcsIHBhdGggJHthYnNvbHV0ZUxvY2FsRmlsZX0gZG9lcyBub3QgZXhpc3Qgb3IgaXMgbm90IHJlYWRhYmxlYCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCB7XG4gICAgICBjb25maWcud2ViLmxvZ28gPSB1bmRlZmluZWQ7XG4gICAgICBsb2dnZXIud2Fybihgd2ViIGxvZ28gaXMgd3JvbmcsIHBhdGggJHthYnNvbHV0ZUxvY2FsRmlsZX0gZG9lcyBub3QgZXhpc3Qgb3IgaXMgbm90IHJlYWRhYmxlYCk7XG4gICAgfVxuICB9XG5cbiAgcm91dGVyLmdldCgnLy0vd2ViLzpzZWN0aW9uLyonLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICByZW5kZXJIVE1MKGNvbmZpZywgbWFuaWZlc3QsIG1hbmlmZXN0RmlsZXMsIHJlcSwgcmVzKTtcbiAgICBkZWJ1ZygncmVuZGVyIGh0bWwgc2VjdGlvbicpO1xuICB9KTtcblxuICByb3V0ZXIuZ2V0KCcvJywgZnVuY3Rpb24gKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgcmVuZGVySFRNTChjb25maWcsIG1hbmlmZXN0LCBtYW5pZmVzdEZpbGVzLCByZXEsIHJlcyk7XG4gICAgZGVidWcoJ3JlbmRlciByb290Jyk7XG4gIH0pO1xuXG4gIHJldHVybiByb3V0ZXI7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUlBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUEsTUFBTTtFQUFFQTtBQUFGLElBQTRCQyxPQUFPLENBQUMsZUFBRCxDQUF6Qzs7QUFFQSxN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